2026-01-04 20:04:16,865 [INFO] [Client 3] Building local memory banks for categories: ['underbody_pipes', 'underbody_screw']
2026-01-04 20:04:16,865 [INFO] [Client 3] fit(underbody_pipes) start
2026-01-04 20:04:16,866 [INFO] Starting feature extraction for underbody_pipes (images=161)
Extracting underbody_pipes features:   0%|          | 0/41 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:190: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting underbody_pipes features:   2%|2         | 1/41 [00:14<09:25, 14.14s/it]Extracting underbody_pipes features:   5%|4         | 2/41 [00:14<03:53,  5.98s/it]Extracting underbody_pipes features:   7%|7         | 3/41 [00:14<02:07,  3.36s/it]Extracting underbody_pipes features:  10%|9         | 4/41 [00:14<01:18,  2.13s/it]Extracting underbody_pipes features:  12%|#2        | 5/41 [00:15<00:52,  1.45s/it]Extracting underbody_pipes features:  15%|#4        | 6/41 [00:15<00:36,  1.05s/it]Extracting underbody_pipes features:  17%|#7        | 7/41 [00:15<00:26,  1.26it/s]Extracting underbody_pipes features:  20%|#9        | 8/41 [00:15<00:20,  1.62it/s]Extracting underbody_pipes features:  22%|##1       | 9/41 [00:16<00:16,  1.98it/s]Extracting underbody_pipes features:  24%|##4       | 10/41 [00:16<00:13,  2.34it/s]Extracting underbody_pipes features:  27%|##6       | 11/41 [00:16<00:11,  2.65it/s]Extracting underbody_pipes features:  29%|##9       | 12/41 [00:16<00:09,  3.00it/s]Extracting underbody_pipes features:  32%|###1      | 13/41 [00:17<00:08,  3.31it/s]Extracting underbody_pipes features:  34%|###4      | 14/41 [00:17<00:07,  3.50it/s]Extracting underbody_pipes features:  37%|###6      | 15/41 [00:17<00:07,  3.66it/s]Extracting underbody_pipes features:  39%|###9      | 16/41 [00:17<00:06,  3.79it/s]Extracting underbody_pipes features:  41%|####1     | 17/41 [00:18<00:05,  4.03it/s]Extracting underbody_pipes features:  44%|####3     | 18/41 [00:18<00:05,  4.08it/s]Extracting underbody_pipes features:  46%|####6     | 19/41 [00:18<00:05,  4.05it/s]Extracting underbody_pipes features:  49%|####8     | 20/41 [00:18<00:05,  4.01it/s]Extracting underbody_pipes features:  51%|#####1    | 21/41 [00:19<00:04,  4.06it/s]Extracting underbody_pipes features:  54%|#####3    | 22/41 [00:19<00:04,  4.00it/s]Extracting underbody_pipes features:  56%|#####6    | 23/41 [00:19<00:04,  3.93it/s]Extracting underbody_pipes features:  59%|#####8    | 24/41 [00:19<00:04,  3.88it/s]Extracting underbody_pipes features:  61%|######    | 25/41 [00:20<00:04,  3.86it/s]Extracting underbody_pipes features:  63%|######3   | 26/41 [00:20<00:03,  3.84it/s]Extracting underbody_pipes features:  66%|######5   | 27/41 [00:20<00:03,  3.79it/s]Extracting underbody_pipes features:  68%|######8   | 28/41 [00:20<00:03,  3.82it/s]Extracting underbody_pipes features:  71%|#######   | 29/41 [00:21<00:03,  3.89it/s]Extracting underbody_pipes features:  73%|#######3  | 30/41 [00:21<00:02,  3.91it/s]Extracting underbody_pipes features:  76%|#######5  | 31/41 [00:21<00:02,  3.92it/s]Extracting underbody_pipes features:  78%|#######8  | 32/41 [00:21<00:02,  3.88it/s]Extracting underbody_pipes features:  80%|########  | 33/41 [00:22<00:02,  3.87it/s]Extracting underbody_pipes features:  83%|########2 | 34/41 [00:22<00:01,  3.83it/s]Extracting underbody_pipes features:  85%|########5 | 35/41 [00:22<00:01,  3.93it/s]Extracting underbody_pipes features:  88%|########7 | 36/41 [00:23<00:01,  3.77it/s]Extracting underbody_pipes features:  90%|######### | 37/41 [00:23<00:00,  4.14it/s]Extracting underbody_pipes features:  93%|#########2| 38/41 [00:23<00:00,  4.29it/s]Extracting underbody_pipes features:  95%|#########5| 39/41 [00:23<00:00,  4.22it/s]Extracting underbody_pipes features:  98%|#########7| 40/41 [00:23<00:00,  4.32it/s]Extracting underbody_pipes features: 100%|##########| 41/41 [00:24<00:00,  1.67it/s]
2026-01-04 20:04:41,583 [INFO] Finished feature extraction for underbody_pipes (patches=659456, dim=1536) in 24.54s (6.56 images/sec)
2026-01-04 20:04:41,584 [INFO] Applying random coreset sampling (ratio=0.100 total=659456 target=5000)
2026-01-04 20:04:41,588 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:04:41,728 [INFO] Saved underbody_pipes checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_3\underbody_pipes_patchcore.pt
2026-01-04 20:04:41,728 [INFO] [Client 3] fit(underbody_pipes) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_3\underbody_pipes_patchcore.pt
2026-01-04 20:04:41,808 [INFO] [Client 3] fit(underbody_screw) start
2026-01-04 20:04:41,809 [INFO] Starting feature extraction for underbody_screw (images=373)
Extracting underbody_screw features:   0%|          | 0/94 [00:00<?, ?it/s]Extracting underbody_screw features:   1%|1         | 1/94 [00:13<20:52, 13.47s/it]Extracting underbody_screw features:   3%|3         | 3/94 [00:13<05:21,  3.53s/it]Extracting underbody_screw features:  10%|9         | 9/94 [00:13<01:13,  1.16it/s]Extracting underbody_screw features:  14%|#3        | 13/94 [00:13<00:41,  1.96it/s]Extracting underbody_screw features:  19%|#9        | 18/94 [00:13<00:22,  3.33it/s]Extracting underbody_screw features:  26%|##5       | 24/94 [00:14<00:12,  5.52it/s]Extracting underbody_screw features:  31%|###       | 29/94 [00:14<00:08,  7.76it/s]Extracting underbody_screw features:  37%|###7      | 35/94 [00:14<00:05, 11.16it/s]Extracting underbody_screw features:  43%|####2     | 40/94 [00:14<00:03, 14.34it/s]Extracting underbody_screw features:  48%|####7     | 45/94 [00:15<00:04, 11.55it/s]Extracting underbody_screw features:  52%|#####2    | 49/94 [00:15<00:05,  7.89it/s]Extracting underbody_screw features:  55%|#####5    | 52/94 [00:16<00:06,  6.48it/s]Extracting underbody_screw features:  57%|#####7    | 54/94 [00:17<00:06,  5.84it/s]Extracting underbody_screw features:  60%|#####9    | 56/94 [00:17<00:07,  5.33it/s]Extracting underbody_screw features:  62%|######1   | 58/94 [00:18<00:07,  5.01it/s]Extracting underbody_screw features:  63%|######2   | 59/94 [00:18<00:07,  4.79it/s]Extracting underbody_screw features:  64%|######3   | 60/94 [00:18<00:07,  4.63it/s]Extracting underbody_screw features:  65%|######4   | 61/94 [00:19<00:07,  4.54it/s]Extracting underbody_screw features:  66%|######5   | 62/94 [00:19<00:07,  4.42it/s]Extracting underbody_screw features:  67%|######7   | 63/94 [00:19<00:07,  4.30it/s]Extracting underbody_screw features:  68%|######8   | 64/94 [00:19<00:07,  4.15it/s]Extracting underbody_screw features:  69%|######9   | 65/94 [00:20<00:07,  4.14it/s]Extracting underbody_screw features:  70%|#######   | 66/94 [00:20<00:06,  4.10it/s]Extracting underbody_screw features:  71%|#######1  | 67/94 [00:20<00:06,  4.08it/s]Extracting underbody_screw features:  72%|#######2  | 68/94 [00:20<00:06,  4.04it/s]Extracting underbody_screw features:  73%|#######3  | 69/94 [00:21<00:06,  4.02it/s]Extracting underbody_screw features:  74%|#######4  | 70/94 [00:21<00:05,  4.05it/s]Extracting underbody_screw features:  76%|#######5  | 71/94 [00:21<00:05,  4.01it/s]Extracting underbody_screw features:  77%|#######6  | 72/94 [00:21<00:05,  3.99it/s]Extracting underbody_screw features:  78%|#######7  | 73/94 [00:22<00:05,  3.95it/s]Extracting underbody_screw features:  79%|#######8  | 74/94 [00:22<00:05,  3.90it/s]Extracting underbody_screw features:  80%|#######9  | 75/94 [00:22<00:04,  3.86it/s]Extracting underbody_screw features:  81%|########  | 76/94 [00:22<00:04,  3.82it/s]Extracting underbody_screw features:  82%|########1 | 77/94 [00:23<00:04,  3.88it/s]Extracting underbody_screw features:  83%|########2 | 78/94 [00:23<00:03,  4.30it/s]Extracting underbody_screw features:  84%|########4 | 79/94 [00:23<00:03,  4.48it/s]Extracting underbody_screw features:  85%|########5 | 80/94 [00:23<00:02,  4.72it/s]Extracting underbody_screw features:  86%|########6 | 81/94 [00:23<00:02,  4.89it/s]Extracting underbody_screw features:  87%|########7 | 82/94 [00:24<00:02,  5.09it/s]Extracting underbody_screw features:  88%|########8 | 83/94 [00:24<00:02,  5.27it/s]Extracting underbody_screw features:  89%|########9 | 84/94 [00:24<00:01,  5.23it/s]Extracting underbody_screw features:  90%|######### | 85/94 [00:24<00:01,  5.20it/s]Extracting underbody_screw features:  91%|#########1| 86/94 [00:24<00:01,  5.73it/s]Extracting underbody_screw features:  93%|#########2| 87/94 [00:24<00:01,  6.18it/s]Extracting underbody_screw features:  94%|#########3| 88/94 [00:25<00:01,  5.69it/s]Extracting underbody_screw features:  95%|#########4| 89/94 [00:25<00:00,  5.66it/s]Extracting underbody_screw features:  96%|#########5| 90/94 [00:25<00:00,  5.63it/s]Extracting underbody_screw features:  97%|#########6| 91/94 [00:25<00:00,  5.97it/s]Extracting underbody_screw features:  98%|#########7| 92/94 [00:25<00:00,  5.37it/s]Extracting underbody_screw features:  99%|#########8| 93/94 [00:25<00:00,  5.26it/s]Extracting underbody_screw features: 100%|##########| 94/94 [00:26<00:00,  3.55it/s]
2026-01-04 20:05:08,722 [INFO] Finished feature extraction for underbody_screw (patches=1527808, dim=1536) in 26.51s (14.07 images/sec)
2026-01-04 20:05:08,722 [INFO] Applying random coreset sampling (ratio=0.100 total=1527808 target=5000)
2026-01-04 20:05:08,731 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:05:08,977 [INFO] Saved underbody_screw checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_3\underbody_screw_patchcore.pt
2026-01-04 20:05:08,978 [INFO] [Client 3] fit(underbody_screw) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_3\underbody_screw_patchcore.pt
2026-01-04 20:05:09,193 [INFO] [Client 3] Upload OK
