2026-01-04 20:03:22,722 [INFO] [Client 2] Building local memory banks for categories: ['pipe_staple', 'tank_screw']
2026-01-04 20:03:22,722 [INFO] [Client 2] fit(pipe_staple) start
2026-01-04 20:03:22,723 [INFO] Starting feature extraction for pipe_staple (images=191)
Extracting pipe_staple features:   0%|          | 0/48 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:190: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting pipe_staple features:   2%|2         | 1/48 [00:14<11:22, 14.51s/it]Extracting pipe_staple features:   4%|4         | 2/48 [00:14<04:40,  6.09s/it]Extracting pipe_staple features:   6%|6         | 3/48 [00:14<02:33,  3.41s/it]Extracting pipe_staple features:   8%|8         | 4/48 [00:15<01:34,  2.15s/it]Extracting pipe_staple features:  10%|#         | 5/48 [00:15<01:03,  1.47s/it]Extracting pipe_staple features:  12%|#2        | 6/48 [00:15<00:43,  1.04s/it]Extracting pipe_staple features:  15%|#4        | 7/48 [00:15<00:31,  1.29it/s]Extracting pipe_staple features:  17%|#6        | 8/48 [00:16<00:24,  1.63it/s]Extracting pipe_staple features:  19%|#8        | 9/48 [00:16<00:19,  2.02it/s]Extracting pipe_staple features:  21%|##        | 10/48 [00:16<00:16,  2.37it/s]Extracting pipe_staple features:  23%|##2       | 11/48 [00:16<00:13,  2.77it/s]Extracting pipe_staple features:  25%|##5       | 12/48 [00:17<00:11,  3.07it/s]Extracting pipe_staple features:  27%|##7       | 13/48 [00:17<00:10,  3.40it/s]Extracting pipe_staple features:  29%|##9       | 14/48 [00:17<00:09,  3.72it/s]Extracting pipe_staple features:  31%|###1      | 15/48 [00:17<00:08,  3.89it/s]Extracting pipe_staple features:  33%|###3      | 16/48 [00:17<00:08,  3.97it/s]Extracting pipe_staple features:  35%|###5      | 17/48 [00:18<00:07,  4.04it/s]Extracting pipe_staple features:  38%|###7      | 18/48 [00:18<00:07,  4.09it/s]Extracting pipe_staple features:  40%|###9      | 19/48 [00:18<00:07,  4.06it/s]Extracting pipe_staple features:  42%|####1     | 20/48 [00:18<00:07,  3.91it/s]Extracting pipe_staple features:  44%|####3     | 21/48 [00:19<00:06,  4.04it/s]Extracting pipe_staple features:  46%|####5     | 22/48 [00:19<00:06,  4.17it/s]Extracting pipe_staple features:  48%|####7     | 23/48 [00:19<00:05,  4.18it/s]Extracting pipe_staple features:  50%|#####     | 24/48 [00:19<00:05,  4.27it/s]Extracting pipe_staple features:  52%|#####2    | 25/48 [00:20<00:05,  4.28it/s]Extracting pipe_staple features:  54%|#####4    | 26/48 [00:20<00:05,  4.17it/s]Extracting pipe_staple features:  56%|#####6    | 27/48 [00:20<00:05,  3.91it/s]Extracting pipe_staple features:  58%|#####8    | 28/48 [00:20<00:04,  4.16it/s]Extracting pipe_staple features:  60%|######    | 29/48 [00:21<00:04,  4.22it/s]Extracting pipe_staple features:  62%|######2   | 30/48 [00:21<00:04,  4.20it/s]Extracting pipe_staple features:  65%|######4   | 31/48 [00:21<00:04,  4.03it/s]Extracting pipe_staple features:  67%|######6   | 32/48 [00:21<00:03,  4.11it/s]Extracting pipe_staple features:  69%|######8   | 33/48 [00:22<00:03,  4.13it/s]Extracting pipe_staple features:  71%|#######   | 34/48 [00:22<00:03,  4.09it/s]Extracting pipe_staple features:  73%|#######2  | 35/48 [00:22<00:03,  4.11it/s]Extracting pipe_staple features:  75%|#######5  | 36/48 [00:22<00:02,  4.11it/s]Extracting pipe_staple features:  77%|#######7  | 37/48 [00:23<00:02,  4.29it/s]Extracting pipe_staple features:  79%|#######9  | 38/48 [00:23<00:02,  4.16it/s]Extracting pipe_staple features:  81%|########1 | 39/48 [00:23<00:02,  4.08it/s]Extracting pipe_staple features:  83%|########3 | 40/48 [00:23<00:01,  4.25it/s]Extracting pipe_staple features:  85%|########5 | 41/48 [00:24<00:01,  4.21it/s]Extracting pipe_staple features:  88%|########7 | 42/48 [00:24<00:01,  4.19it/s]Extracting pipe_staple features:  90%|########9 | 43/48 [00:24<00:01,  4.38it/s]Extracting pipe_staple features:  92%|#########1| 44/48 [00:24<00:00,  4.32it/s]Extracting pipe_staple features:  94%|#########3| 45/48 [00:24<00:00,  3.99it/s]Extracting pipe_staple features:  96%|#########5| 46/48 [00:25<00:00,  3.88it/s]Extracting pipe_staple features:  98%|#########7| 47/48 [00:25<00:00,  3.69it/s]Extracting pipe_staple features: 100%|##########| 48/48 [00:25<00:00,  3.64it/s]Extracting pipe_staple features: 100%|##########| 48/48 [00:26<00:00,  1.81it/s]
2026-01-04 20:03:49,392 [INFO] Finished feature extraction for pipe_staple (patches=782336, dim=1536) in 26.46s (7.22 images/sec)
2026-01-04 20:03:49,393 [INFO] Applying random coreset sampling (ratio=0.100 total=782336 target=5000)
2026-01-04 20:03:49,398 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:03:49,549 [INFO] Saved pipe_staple checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_2\pipe_staple_patchcore.pt
2026-01-04 20:03:49,549 [INFO] [Client 2] fit(pipe_staple) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_2\pipe_staple_patchcore.pt
2026-01-04 20:03:49,623 [INFO] [Client 2] fit(tank_screw) start
2026-01-04 20:03:49,624 [INFO] Starting feature extraction for tank_screw (images=318)
Extracting tank_screw features:   0%|          | 0/80 [00:00<?, ?it/s]Extracting tank_screw features:   1%|1         | 1/80 [00:13<17:43, 13.46s/it]Extracting tank_screw features:   4%|3         | 3/80 [00:13<04:32,  3.53s/it]Extracting tank_screw features:  11%|#1        | 9/80 [00:13<01:01,  1.16it/s]Extracting tank_screw features:  18%|#7        | 14/80 [00:13<00:30,  2.17it/s]Extracting tank_screw features:  25%|##5       | 20/80 [00:13<00:15,  3.82it/s]Extracting tank_screw features:  31%|###1      | 25/80 [00:13<00:09,  5.61it/s]Extracting tank_screw features:  40%|####      | 32/80 [00:14<00:05,  8.94it/s]Extracting tank_screw features:  48%|####7     | 38/80 [00:14<00:03, 12.49it/s]Extracting tank_screw features:  55%|#####5    | 44/80 [00:14<00:02, 16.61it/s]Extracting tank_screw features:  62%|######2   | 50/80 [00:14<00:01, 18.06it/s]Extracting tank_screw features:  69%|######8   | 55/80 [00:15<00:02,  9.37it/s]Extracting tank_screw features:  74%|#######3  | 59/80 [00:16<00:02,  7.13it/s]Extracting tank_screw features:  78%|#######7  | 62/80 [00:17<00:02,  6.19it/s]Extracting tank_screw features:  80%|########  | 64/80 [00:18<00:02,  5.68it/s]Extracting tank_screw features:  82%|########2 | 66/80 [00:18<00:02,  5.24it/s]Extracting tank_screw features:  85%|########5 | 68/80 [00:19<00:02,  4.89it/s]Extracting tank_screw features:  86%|########6 | 69/80 [00:19<00:02,  4.75it/s]Extracting tank_screw features:  88%|########7 | 70/80 [00:19<00:02,  4.58it/s]Extracting tank_screw features:  89%|########8 | 71/80 [00:19<00:02,  4.35it/s]Extracting tank_screw features:  90%|######### | 72/80 [00:20<00:01,  4.34it/s]Extracting tank_screw features:  91%|#########1| 73/80 [00:20<00:01,  4.21it/s]Extracting tank_screw features:  92%|#########2| 74/80 [00:20<00:01,  4.28it/s]Extracting tank_screw features:  94%|#########3| 75/80 [00:20<00:01,  4.38it/s]Extracting tank_screw features:  95%|#########5| 76/80 [00:21<00:00,  4.40it/s]Extracting tank_screw features:  96%|#########6| 77/80 [00:21<00:00,  4.47it/s]Extracting tank_screw features:  98%|#########7| 78/80 [00:21<00:00,  4.16it/s]Extracting tank_screw features: 100%|##########| 80/80 [00:22<00:00,  3.61it/s]
2026-01-04 20:04:12,155 [INFO] Finished feature extraction for tank_screw (patches=1302528, dim=1536) in 22.16s (14.35 images/sec)
2026-01-04 20:04:12,155 [INFO] Applying random coreset sampling (ratio=0.100 total=1302528 target=5000)
2026-01-04 20:04:12,165 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:04:12,442 [INFO] Saved tank_screw checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_2\tank_screw_patchcore.pt
2026-01-04 20:04:12,442 [INFO] [Client 2] fit(tank_screw) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_2\tank_screw_patchcore.pt
2026-01-04 20:04:12,612 [INFO] [Client 2] Upload OK
