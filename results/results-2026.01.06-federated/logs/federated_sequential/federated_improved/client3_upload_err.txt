2026-01-04 20:52:26,509 [INFO] [Client 3] Building local memory banks for categories: ['underbody_pipes', 'underbody_screw']
2026-01-04 20:52:26,509 [INFO] [Client 3] fit(underbody_pipes) start
2026-01-04 20:52:26,509 [INFO] Starting feature extraction for underbody_pipes (images=161)
Extracting underbody_pipes features:   0%|          | 0/41 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:217: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting underbody_pipes features:   2%|2         | 1/41 [00:12<08:19, 12.49s/it]Extracting underbody_pipes features:   5%|4         | 2/41 [00:12<03:25,  5.26s/it]Extracting underbody_pipes features:   7%|7         | 3/41 [00:12<01:52,  2.95s/it]Extracting underbody_pipes features:  10%|9         | 4/41 [00:13<01:08,  1.86s/it]Extracting underbody_pipes features:  12%|#2        | 5/41 [00:13<00:45,  1.25s/it]Extracting underbody_pipes features:  15%|#4        | 6/41 [00:13<00:31,  1.12it/s]Extracting underbody_pipes features:  17%|#7        | 7/41 [00:13<00:22,  1.51it/s]Extracting underbody_pipes features:  20%|#9        | 8/41 [00:13<00:16,  1.95it/s]Extracting underbody_pipes features:  22%|##1       | 9/41 [00:14<00:13,  2.42it/s]Extracting underbody_pipes features:  24%|##4       | 10/41 [00:14<00:10,  2.93it/s]Extracting underbody_pipes features:  27%|##6       | 11/41 [00:14<00:08,  3.41it/s]Extracting underbody_pipes features:  29%|##9       | 12/41 [00:14<00:07,  3.95it/s]Extracting underbody_pipes features:  32%|###1      | 13/41 [00:14<00:06,  4.32it/s]Extracting underbody_pipes features:  34%|###4      | 14/41 [00:14<00:05,  4.61it/s]Extracting underbody_pipes features:  37%|###6      | 15/41 [00:15<00:05,  4.82it/s]Extracting underbody_pipes features:  39%|###9      | 16/41 [00:15<00:04,  5.06it/s]Extracting underbody_pipes features:  41%|####1     | 17/41 [00:15<00:04,  5.07it/s]Extracting underbody_pipes features:  44%|####3     | 18/41 [00:15<00:04,  5.15it/s]Extracting underbody_pipes features:  46%|####6     | 19/41 [00:15<00:04,  5.24it/s]Extracting underbody_pipes features:  49%|####8     | 20/41 [00:16<00:04,  5.25it/s]Extracting underbody_pipes features:  51%|#####1    | 21/41 [00:16<00:03,  5.29it/s]Extracting underbody_pipes features:  54%|#####3    | 22/41 [00:16<00:03,  5.32it/s]Extracting underbody_pipes features:  56%|#####6    | 23/41 [00:16<00:03,  5.31it/s]Extracting underbody_pipes features:  59%|#####8    | 24/41 [00:16<00:03,  5.34it/s]Extracting underbody_pipes features:  61%|######    | 25/41 [00:16<00:02,  5.39it/s]Extracting underbody_pipes features:  63%|######3   | 26/41 [00:17<00:02,  5.37it/s]Extracting underbody_pipes features:  66%|######5   | 27/41 [00:17<00:02,  5.25it/s]Extracting underbody_pipes features:  68%|######8   | 28/41 [00:17<00:02,  5.28it/s]Extracting underbody_pipes features:  71%|#######   | 29/41 [00:17<00:02,  5.28it/s]Extracting underbody_pipes features:  73%|#######3  | 30/41 [00:17<00:02,  5.27it/s]Extracting underbody_pipes features:  76%|#######5  | 31/41 [00:18<00:01,  5.20it/s]Extracting underbody_pipes features:  78%|#######8  | 32/41 [00:18<00:01,  5.24it/s]Extracting underbody_pipes features:  80%|########  | 33/41 [00:18<00:01,  4.90it/s]Extracting underbody_pipes features:  83%|########2 | 34/41 [00:18<00:01,  4.83it/s]Extracting underbody_pipes features:  85%|########5 | 35/41 [00:18<00:01,  5.03it/s]Extracting underbody_pipes features:  88%|########7 | 36/41 [00:19<00:00,  5.35it/s]Extracting underbody_pipes features:  90%|######### | 37/41 [00:19<00:00,  5.81it/s]Extracting underbody_pipes features:  93%|#########2| 38/41 [00:19<00:00,  6.04it/s]Extracting underbody_pipes features:  95%|#########5| 39/41 [00:19<00:00,  5.97it/s]Extracting underbody_pipes features:  98%|#########7| 40/41 [00:19<00:00,  6.40it/s]Extracting underbody_pipes features: 100%|##########| 41/41 [00:20<00:00,  2.02it/s]
2026-01-04 20:52:46,946 [INFO] Finished feature extraction for underbody_pipes (patches=659456, dim=1536) in 20.25s (7.95 images/sec)
2026-01-04 20:52:46,947 [INFO] Applying random coreset sampling (ratio=0.100 total=659456 target=5000)
2026-01-04 20:52:46,951 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:52:47,072 [INFO] Saved underbody_pipes checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_3\underbody_pipes_patchcore.pt
2026-01-04 20:52:47,073 [INFO] [Client 3] fit(underbody_pipes) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_3\underbody_pipes_patchcore.pt
2026-01-04 20:52:47,136 [INFO] [Client 3] fit(underbody_screw) start
2026-01-04 20:52:47,137 [INFO] Starting feature extraction for underbody_screw (images=373)
Extracting underbody_screw features:   0%|          | 0/94 [00:00<?, ?it/s]Extracting underbody_screw features:   1%|1         | 1/94 [00:11<17:49, 11.50s/it]Extracting underbody_screw features:   4%|4         | 4/94 [00:11<03:18,  2.20s/it]Extracting underbody_screw features:  10%|9         | 9/94 [00:11<01:05,  1.31it/s]Extracting underbody_screw features:  16%|#5        | 15/94 [00:11<00:29,  2.71it/s]Extracting underbody_screw features:  23%|##3       | 22/94 [00:11<00:14,  4.91it/s]Extracting underbody_screw features:  30%|##9       | 28/94 [00:12<00:08,  7.37it/s]Extracting underbody_screw features:  36%|###6      | 34/94 [00:12<00:05, 10.44it/s]Extracting underbody_screw features:  43%|####2     | 40/94 [00:12<00:03, 14.26it/s]Extracting underbody_screw features:  49%|####8     | 46/94 [00:12<00:04, 11.89it/s]Extracting underbody_screw features:  53%|#####3    | 50/94 [00:13<00:04,  9.25it/s]Extracting underbody_screw features:  56%|#####6    | 53/94 [00:14<00:05,  8.18it/s]Extracting underbody_screw features:  60%|#####9    | 56/94 [00:14<00:05,  7.31it/s]Extracting underbody_screw features:  62%|######1   | 58/94 [00:15<00:05,  6.90it/s]Extracting underbody_screw features:  64%|######3   | 60/94 [00:15<00:05,  6.63it/s]Extracting underbody_screw features:  66%|######5   | 62/94 [00:15<00:04,  6.99it/s]Extracting underbody_screw features:  68%|######8   | 64/94 [00:16<00:04,  6.56it/s]Extracting underbody_screw features:  69%|######9   | 65/94 [00:16<00:04,  6.36it/s]Extracting underbody_screw features:  70%|#######   | 66/94 [00:16<00:04,  6.17it/s]Extracting underbody_screw features:  71%|#######1  | 67/94 [00:16<00:04,  5.92it/s]Extracting underbody_screw features:  72%|#######2  | 68/94 [00:16<00:04,  5.72it/s]Extracting underbody_screw features:  73%|#######3  | 69/94 [00:17<00:04,  5.60it/s]Extracting underbody_screw features:  74%|#######4  | 70/94 [00:17<00:04,  5.49it/s]Extracting underbody_screw features:  76%|#######5  | 71/94 [00:17<00:04,  5.29it/s]Extracting underbody_screw features:  77%|#######6  | 72/94 [00:17<00:04,  5.43it/s]Extracting underbody_screw features:  78%|#######7  | 73/94 [00:17<00:03,  5.33it/s]Extracting underbody_screw features:  79%|#######8  | 74/94 [00:17<00:03,  5.40it/s]Extracting underbody_screw features:  80%|#######9  | 75/94 [00:18<00:03,  5.38it/s]Extracting underbody_screw features:  81%|########  | 76/94 [00:18<00:03,  5.42it/s]Extracting underbody_screw features:  82%|########1 | 77/94 [00:18<00:03,  5.45it/s]Extracting underbody_screw features:  83%|########2 | 78/94 [00:18<00:02,  5.58it/s]Extracting underbody_screw features:  84%|########4 | 79/94 [00:18<00:02,  5.82it/s]Extracting underbody_screw features:  85%|########5 | 80/94 [00:19<00:02,  5.85it/s]Extracting underbody_screw features:  86%|########6 | 81/94 [00:19<00:02,  5.51it/s]Extracting underbody_screw features:  87%|########7 | 82/94 [00:19<00:02,  5.38it/s]Extracting underbody_screw features:  88%|########8 | 83/94 [00:19<00:02,  5.47it/s]Extracting underbody_screw features:  89%|########9 | 84/94 [00:19<00:01,  5.31it/s]Extracting underbody_screw features:  90%|######### | 85/94 [00:20<00:01,  5.13it/s]Extracting underbody_screw features:  91%|#########1| 86/94 [00:20<00:01,  5.57it/s]Extracting underbody_screw features:  93%|#########2| 87/94 [00:20<00:01,  5.79it/s]Extracting underbody_screw features:  94%|#########3| 88/94 [00:20<00:00,  6.07it/s]Extracting underbody_screw features:  95%|#########4| 89/94 [00:20<00:00,  6.38it/s]Extracting underbody_screw features:  96%|#########5| 90/94 [00:20<00:00,  6.72it/s]Extracting underbody_screw features:  97%|#########6| 91/94 [00:20<00:00,  6.64it/s]Extracting underbody_screw features:  98%|#########7| 92/94 [00:21<00:00,  6.84it/s]Extracting underbody_screw features:  99%|#########8| 93/94 [00:21<00:00,  6.09it/s]Extracting underbody_screw features: 100%|##########| 94/94 [00:21<00:00,  4.32it/s]
2026-01-04 20:53:09,282 [INFO] Finished feature extraction for underbody_screw (patches=1527808, dim=1536) in 21.74s (17.16 images/sec)
2026-01-04 20:53:09,282 [INFO] Applying random coreset sampling (ratio=0.100 total=1527808 target=5000)
2026-01-04 20:53:09,290 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:53:09,525 [INFO] Saved underbody_screw checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_3\underbody_screw_patchcore.pt
2026-01-04 20:53:09,526 [INFO] [Client 3] fit(underbody_screw) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_3\underbody_screw_patchcore.pt
2026-01-04 20:53:09,683 [INFO] [Client 3] Upload OK
