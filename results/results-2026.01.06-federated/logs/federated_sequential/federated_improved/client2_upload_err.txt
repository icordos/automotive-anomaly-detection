2026-01-04 20:51:49,838 [INFO] [Client 2] Building local memory banks for categories: ['engine_wiring', 'tank_screw']
2026-01-04 20:51:49,839 [INFO] [Client 2] fit(engine_wiring) start
2026-01-04 20:51:49,840 [INFO] Starting feature extraction for engine_wiring (images=141)
Extracting engine_wiring features:   0%|          | 0/36 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:217: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting engine_wiring features:   3%|2         | 1/36 [00:12<07:14, 12.41s/it]Extracting engine_wiring features:   6%|5         | 2/36 [00:12<02:57,  5.23s/it]Extracting engine_wiring features:   8%|8         | 3/36 [00:12<01:36,  2.91s/it]Extracting engine_wiring features:  11%|#1        | 4/36 [00:12<00:58,  1.82s/it]Extracting engine_wiring features:  14%|#3        | 5/36 [00:13<00:37,  1.23s/it]Extracting engine_wiring features:  17%|#6        | 6/36 [00:13<00:26,  1.14it/s]Extracting engine_wiring features:  19%|#9        | 7/36 [00:13<00:18,  1.55it/s]Extracting engine_wiring features:  22%|##2       | 8/36 [00:13<00:13,  2.05it/s]Extracting engine_wiring features:  25%|##5       | 9/36 [00:13<00:10,  2.53it/s]Extracting engine_wiring features:  28%|##7       | 10/36 [00:13<00:08,  3.12it/s]Extracting engine_wiring features:  31%|###       | 11/36 [00:14<00:06,  3.61it/s]Extracting engine_wiring features:  33%|###3      | 12/36 [00:14<00:06,  3.98it/s]Extracting engine_wiring features:  36%|###6      | 13/36 [00:14<00:05,  4.44it/s]Extracting engine_wiring features:  39%|###8      | 14/36 [00:14<00:04,  4.76it/s]Extracting engine_wiring features:  42%|####1     | 15/36 [00:14<00:04,  5.24it/s]Extracting engine_wiring features:  44%|####4     | 16/36 [00:14<00:03,  5.49it/s]Extracting engine_wiring features:  47%|####7     | 17/36 [00:15<00:03,  5.65it/s]Extracting engine_wiring features:  50%|#####     | 18/36 [00:15<00:03,  5.46it/s]Extracting engine_wiring features:  53%|#####2    | 19/36 [00:15<00:03,  5.53it/s]Extracting engine_wiring features:  56%|#####5    | 20/36 [00:15<00:02,  5.73it/s]Extracting engine_wiring features:  58%|#####8    | 21/36 [00:15<00:02,  5.79it/s]Extracting engine_wiring features:  61%|######1   | 22/36 [00:15<00:02,  6.02it/s]Extracting engine_wiring features:  64%|######3   | 23/36 [00:16<00:02,  6.11it/s]Extracting engine_wiring features:  67%|######6   | 24/36 [00:16<00:01,  6.10it/s]Extracting engine_wiring features:  69%|######9   | 25/36 [00:16<00:01,  6.25it/s]Extracting engine_wiring features:  72%|#######2  | 26/36 [00:16<00:01,  6.24it/s]Extracting engine_wiring features:  75%|#######5  | 27/36 [00:16<00:01,  6.02it/s]Extracting engine_wiring features:  78%|#######7  | 28/36 [00:16<00:01,  6.33it/s]Extracting engine_wiring features:  81%|########  | 29/36 [00:17<00:01,  6.65it/s]Extracting engine_wiring features:  83%|########3 | 30/36 [00:17<00:00,  6.93it/s]Extracting engine_wiring features:  86%|########6 | 31/36 [00:17<00:00,  6.78it/s]Extracting engine_wiring features:  89%|########8 | 32/36 [00:17<00:00,  6.57it/s]Extracting engine_wiring features:  92%|#########1| 33/36 [00:17<00:00,  6.87it/s]Extracting engine_wiring features:  94%|#########4| 34/36 [00:17<00:00,  5.67it/s]Extracting engine_wiring features:  97%|#########7| 35/36 [00:18<00:00,  6.01it/s]Extracting engine_wiring features: 100%|##########| 36/36 [00:18<00:00,  1.94it/s]
2026-01-04 20:52:08,580 [INFO] Finished feature extraction for engine_wiring (patches=577536, dim=1536) in 18.59s (7.58 images/sec)
2026-01-04 20:52:08,580 [INFO] Applying random coreset sampling (ratio=0.100 total=577536 target=5000)
2026-01-04 20:52:08,583 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:52:08,688 [INFO] Saved engine_wiring checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_2\engine_wiring_patchcore.pt
2026-01-04 20:52:08,689 [INFO] [Client 2] fit(engine_wiring) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_2\engine_wiring_patchcore.pt
2026-01-04 20:52:08,750 [INFO] [Client 2] fit(tank_screw) start
2026-01-04 20:52:08,752 [INFO] Starting feature extraction for tank_screw (images=158)
Extracting tank_screw features:   0%|          | 0/40 [00:00<?, ?it/s]Extracting tank_screw features:   2%|2         | 1/40 [00:11<07:39, 11.79s/it]Extracting tank_screw features:   8%|7         | 3/40 [00:11<01:54,  3.09s/it]Extracting tank_screw features:  22%|##2       | 9/40 [00:12<00:23,  1.32it/s]Extracting tank_screw features:  40%|####      | 16/40 [00:12<00:08,  2.93it/s]Extracting tank_screw features:  55%|#####5    | 22/40 [00:12<00:03,  4.76it/s]Extracting tank_screw features:  72%|#######2  | 29/40 [00:12<00:01,  7.57it/s]Extracting tank_screw features:  88%|########7 | 35/40 [00:12<00:00, 10.63it/s]Extracting tank_screw features: 100%|##########| 40/40 [00:13<00:00,  2.97it/s]
2026-01-04 20:52:22,399 [INFO] Finished feature extraction for tank_screw (patches=647168, dim=1536) in 13.48s (11.72 images/sec)
2026-01-04 20:52:22,399 [INFO] Applying random coreset sampling (ratio=0.100 total=647168 target=5000)
2026-01-04 20:52:22,402 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:52:22,517 [INFO] Saved tank_screw checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_2\tank_screw_patchcore.pt
2026-01-04 20:52:22,518 [INFO] [Client 2] fit(tank_screw) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_2\tank_screw_patchcore.pt
2026-01-04 20:52:22,664 [INFO] [Client 2] Upload OK
