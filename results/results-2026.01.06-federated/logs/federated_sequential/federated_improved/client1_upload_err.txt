2026-01-04 20:51:20,965 [INFO] [Client 1] Building local memory banks for categories: ['engine_wiring', 'pipe_clip']
2026-01-04 20:51:20,965 [INFO] [Client 1] fit(engine_wiring) start
2026-01-04 20:51:20,967 [INFO] Starting feature extraction for engine_wiring (images=144)
Extracting engine_wiring features:   0%|          | 0/36 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:217: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting engine_wiring features:   3%|2         | 1/36 [00:12<07:32, 12.93s/it]Extracting engine_wiring features:   6%|5         | 2/36 [00:13<03:04,  5.44s/it]Extracting engine_wiring features:   8%|8         | 3/36 [00:13<01:40,  3.03s/it]Extracting engine_wiring features:  11%|#1        | 4/36 [00:13<01:00,  1.90s/it]Extracting engine_wiring features:  14%|#3        | 5/36 [00:13<00:39,  1.28s/it]Extracting engine_wiring features:  17%|#6        | 6/36 [00:13<00:26,  1.11it/s]Extracting engine_wiring features:  19%|#9        | 7/36 [00:13<00:19,  1.49it/s]Extracting engine_wiring features:  22%|##2       | 8/36 [00:14<00:14,  1.93it/s]Extracting engine_wiring features:  25%|##5       | 9/36 [00:14<00:11,  2.37it/s]Extracting engine_wiring features:  28%|##7       | 10/36 [00:14<00:08,  2.92it/s]Extracting engine_wiring features:  31%|###       | 11/36 [00:14<00:07,  3.51it/s]Extracting engine_wiring features:  33%|###3      | 12/36 [00:14<00:05,  4.08it/s]Extracting engine_wiring features:  36%|###6      | 13/36 [00:15<00:05,  4.40it/s]Extracting engine_wiring features:  39%|###8      | 14/36 [00:15<00:04,  4.83it/s]Extracting engine_wiring features:  42%|####1     | 15/36 [00:15<00:03,  5.26it/s]Extracting engine_wiring features:  44%|####4     | 16/36 [00:15<00:03,  5.59it/s]Extracting engine_wiring features:  47%|####7     | 17/36 [00:15<00:03,  5.54it/s]Extracting engine_wiring features:  50%|#####     | 18/36 [00:15<00:03,  5.75it/s]Extracting engine_wiring features:  53%|#####2    | 19/36 [00:16<00:02,  5.82it/s]Extracting engine_wiring features:  56%|#####5    | 20/36 [00:16<00:02,  6.04it/s]Extracting engine_wiring features:  58%|#####8    | 21/36 [00:16<00:02,  6.07it/s]Extracting engine_wiring features:  61%|######1   | 22/36 [00:16<00:02,  6.21it/s]Extracting engine_wiring features:  64%|######3   | 23/36 [00:16<00:02,  6.20it/s]Extracting engine_wiring features:  67%|######6   | 24/36 [00:16<00:02,  5.86it/s]Extracting engine_wiring features:  69%|######9   | 25/36 [00:17<00:01,  5.91it/s]Extracting engine_wiring features:  72%|#######2  | 26/36 [00:17<00:01,  5.92it/s]Extracting engine_wiring features:  75%|#######5  | 27/36 [00:17<00:01,  6.02it/s]Extracting engine_wiring features:  78%|#######7  | 28/36 [00:17<00:01,  6.03it/s]Extracting engine_wiring features:  81%|########  | 29/36 [00:17<00:01,  6.34it/s]Extracting engine_wiring features:  83%|########3 | 30/36 [00:17<00:00,  6.67it/s]Extracting engine_wiring features:  86%|########6 | 31/36 [00:17<00:00,  6.79it/s]Extracting engine_wiring features:  89%|########8 | 32/36 [00:18<00:00,  6.32it/s]Extracting engine_wiring features:  92%|#########1| 33/36 [00:18<00:00,  5.36it/s]Extracting engine_wiring features:  94%|#########4| 34/36 [00:18<00:00,  5.74it/s]Extracting engine_wiring features:  97%|#########7| 35/36 [00:18<00:00,  5.42it/s]Extracting engine_wiring features: 100%|##########| 36/36 [00:18<00:00,  5.12it/s]Extracting engine_wiring features: 100%|##########| 36/36 [00:19<00:00,  1.85it/s]
2026-01-04 20:51:40,540 [INFO] Finished feature extraction for engine_wiring (patches=589824, dim=1536) in 19.42s (7.41 images/sec)
2026-01-04 20:51:40,541 [INFO] Applying random coreset sampling (ratio=0.100 total=589824 target=5000)
2026-01-04 20:51:40,544 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:51:40,651 [INFO] Saved engine_wiring checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_1\engine_wiring_patchcore.pt
2026-01-04 20:51:40,651 [INFO] [Client 1] fit(engine_wiring) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_1\engine_wiring_patchcore.pt
2026-01-04 20:51:40,720 [INFO] [Client 1] fit(pipe_clip) start
2026-01-04 20:51:40,721 [INFO] Starting feature extraction for pipe_clip (images=99)
Extracting pipe_clip features:   0%|          | 0/25 [00:00<?, ?it/s]Extracting pipe_clip features:   4%|4         | 1/25 [00:03<01:30,  3.76s/it]Extracting pipe_clip features:   8%|8         | 2/25 [00:03<00:37,  1.61s/it]Extracting pipe_clip features:  24%|##4       | 6/25 [00:03<00:07,  2.56it/s]Extracting pipe_clip features:  52%|#####2    | 13/25 [00:04<00:01,  6.97it/s]Extracting pipe_clip features:  80%|########  | 20/25 [00:04<00:00, 12.31it/s]Extracting pipe_clip features: 100%|##########| 25/25 [00:04<00:00, 14.79it/s]Extracting pipe_clip features: 100%|##########| 25/25 [00:04<00:00,  5.12it/s]
2026-01-04 20:51:45,705 [INFO] Finished feature extraction for pipe_clip (patches=405504, dim=1536) in 4.88s (20.28 images/sec)
2026-01-04 20:51:45,705 [INFO] Applying random coreset sampling (ratio=0.100 total=405504 target=5000)
2026-01-04 20:51:45,708 [INFO] random coreset sampling finished in 0.00s
2026-01-04 20:51:45,814 [INFO] Saved pipe_clip checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_1\pipe_clip_patchcore.pt
2026-01-04 20:51:45,832 [INFO] [Client 1] fit(pipe_clip) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\federated_improved\clients\client_1\pipe_clip_patchcore.pt
2026-01-04 20:51:46,044 [INFO] [Client 1] Upload OK
