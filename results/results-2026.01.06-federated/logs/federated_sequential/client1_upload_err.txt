2026-01-04 20:02:33,273 [INFO] [Client 1] Building local memory banks for categories: ['engine_wiring', 'pipe_clip']
2026-01-04 20:02:33,273 [INFO] [Client 1] fit(engine_wiring) start
2026-01-04 20:02:33,274 [INFO] Starting feature extraction for engine_wiring (images=285)
Extracting engine_wiring features:   0%|          | 0/72 [00:00<?, ?it/s]C:\Users\victo\Documents\GitHub\my-aiml-master\aitwdm-project\federated_sequentially\patchcore_training.py:190: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast():
Extracting engine_wiring features:   1%|1         | 1/72 [00:14<16:58, 14.35s/it]Extracting engine_wiring features:   3%|2         | 2/72 [00:14<07:03,  6.05s/it]Extracting engine_wiring features:   4%|4         | 3/72 [00:14<03:54,  3.40s/it]Extracting engine_wiring features:   6%|5         | 4/72 [00:15<02:26,  2.15s/it]Extracting engine_wiring features:   7%|6         | 5/72 [00:15<01:37,  1.46s/it]Extracting engine_wiring features:   8%|8         | 6/72 [00:15<01:08,  1.04s/it]Extracting engine_wiring features:  10%|9         | 7/72 [00:15<00:50,  1.29it/s]Extracting engine_wiring features:  11%|#1        | 8/72 [00:15<00:38,  1.65it/s]Extracting engine_wiring features:  12%|#2        | 9/72 [00:16<00:30,  2.08it/s]Extracting engine_wiring features:  14%|#3        | 10/72 [00:16<00:25,  2.45it/s]Extracting engine_wiring features:  15%|#5        | 11/72 [00:16<00:21,  2.83it/s]Extracting engine_wiring features:  17%|#6        | 12/72 [00:16<00:18,  3.18it/s]Extracting engine_wiring features:  18%|#8        | 13/72 [00:17<00:16,  3.49it/s]Extracting engine_wiring features:  19%|#9        | 14/72 [00:17<00:15,  3.66it/s]Extracting engine_wiring features:  21%|##        | 15/72 [00:17<00:15,  3.72it/s]Extracting engine_wiring features:  22%|##2       | 16/72 [00:17<00:14,  3.75it/s]Extracting engine_wiring features:  24%|##3       | 17/72 [00:18<00:14,  3.80it/s]Extracting engine_wiring features:  25%|##5       | 18/72 [00:18<00:13,  3.97it/s]Extracting engine_wiring features:  26%|##6       | 19/72 [00:18<00:13,  3.98it/s]Extracting engine_wiring features:  28%|##7       | 20/72 [00:18<00:12,  4.02it/s]Extracting engine_wiring features:  29%|##9       | 21/72 [00:19<00:12,  4.07it/s]Extracting engine_wiring features:  31%|###       | 22/72 [00:19<00:12,  4.05it/s]Extracting engine_wiring features:  32%|###1      | 23/72 [00:19<00:11,  4.18it/s]Extracting engine_wiring features:  33%|###3      | 24/72 [00:19<00:11,  4.12it/s]Extracting engine_wiring features:  35%|###4      | 25/72 [00:20<00:11,  4.16it/s]Extracting engine_wiring features:  36%|###6      | 26/72 [00:20<00:10,  4.31it/s]Extracting engine_wiring features:  38%|###7      | 27/72 [00:20<00:10,  4.10it/s]Extracting engine_wiring features:  39%|###8      | 28/72 [00:20<00:10,  4.17it/s]Extracting engine_wiring features:  40%|####      | 29/72 [00:21<00:10,  4.23it/s]Extracting engine_wiring features:  42%|####1     | 30/72 [00:21<00:09,  4.29it/s]Extracting engine_wiring features:  43%|####3     | 31/72 [00:21<00:09,  4.26it/s]Extracting engine_wiring features:  44%|####4     | 32/72 [00:21<00:09,  4.28it/s]Extracting engine_wiring features:  46%|####5     | 33/72 [00:21<00:09,  4.22it/s]Extracting engine_wiring features:  47%|####7     | 34/72 [00:22<00:08,  4.26it/s]Extracting engine_wiring features:  49%|####8     | 35/72 [00:22<00:08,  4.44it/s]Extracting engine_wiring features:  50%|#####     | 36/72 [00:22<00:07,  4.77it/s]Extracting engine_wiring features:  51%|#####1    | 37/72 [00:22<00:06,  5.14it/s]Extracting engine_wiring features:  53%|#####2    | 38/72 [00:22<00:06,  5.40it/s]Extracting engine_wiring features:  54%|#####4    | 39/72 [00:23<00:05,  5.64it/s]Extracting engine_wiring features:  56%|#####5    | 40/72 [00:23<00:05,  5.79it/s]Extracting engine_wiring features:  57%|#####6    | 41/72 [00:23<00:05,  5.90it/s]Extracting engine_wiring features:  58%|#####8    | 42/72 [00:23<00:05,  5.97it/s]Extracting engine_wiring features:  60%|#####9    | 43/72 [00:23<00:04,  6.10it/s]Extracting engine_wiring features:  61%|######1   | 44/72 [00:23<00:04,  5.99it/s]Extracting engine_wiring features:  62%|######2   | 45/72 [00:24<00:04,  6.07it/s]Extracting engine_wiring features:  64%|######3   | 46/72 [00:24<00:04,  6.03it/s]Extracting engine_wiring features:  65%|######5   | 47/72 [00:24<00:04,  6.05it/s]Extracting engine_wiring features:  67%|######6   | 48/72 [00:24<00:04,  5.94it/s]Extracting engine_wiring features:  68%|######8   | 49/72 [00:24<00:03,  5.98it/s]Extracting engine_wiring features:  69%|######9   | 50/72 [00:24<00:03,  6.03it/s]Extracting engine_wiring features:  71%|#######   | 51/72 [00:24<00:03,  6.13it/s]Extracting engine_wiring features:  72%|#######2  | 52/72 [00:25<00:03,  6.31it/s]Extracting engine_wiring features:  74%|#######3  | 53/72 [00:25<00:03,  6.19it/s]Extracting engine_wiring features:  75%|#######5  | 54/72 [00:25<00:02,  6.18it/s]Extracting engine_wiring features:  76%|#######6  | 55/72 [00:25<00:02,  5.69it/s]Extracting engine_wiring features:  78%|#######7  | 56/72 [00:25<00:03,  5.33it/s]Extracting engine_wiring features:  79%|#######9  | 57/72 [00:26<00:02,  5.48it/s]Extracting engine_wiring features:  81%|########  | 58/72 [00:26<00:02,  5.72it/s]Extracting engine_wiring features:  82%|########1 | 59/72 [00:26<00:02,  5.48it/s]Extracting engine_wiring features:  83%|########3 | 60/72 [00:26<00:02,  5.49it/s]Extracting engine_wiring features:  85%|########4 | 61/72 [00:26<00:01,  5.52it/s]Extracting engine_wiring features:  86%|########6 | 62/72 [00:26<00:01,  5.51it/s]Extracting engine_wiring features:  88%|########7 | 63/72 [00:27<00:01,  5.68it/s]Extracting engine_wiring features:  89%|########8 | 64/72 [00:27<00:01,  5.01it/s]Extracting engine_wiring features:  90%|######### | 65/72 [00:27<00:01,  5.45it/s]Extracting engine_wiring features:  92%|#########1| 66/72 [00:27<00:01,  5.95it/s]Extracting engine_wiring features:  93%|#########3| 67/72 [00:27<00:00,  5.97it/s]Extracting engine_wiring features:  94%|#########4| 68/72 [00:28<00:00,  5.55it/s]Extracting engine_wiring features:  96%|#########5| 69/72 [00:28<00:00,  5.85it/s]Extracting engine_wiring features:  97%|#########7| 70/72 [00:28<00:00,  5.08it/s]Extracting engine_wiring features:  99%|#########8| 71/72 [00:28<00:00,  5.26it/s]Extracting engine_wiring features: 100%|##########| 72/72 [00:29<00:00,  2.47it/s]
2026-01-04 20:03:02,787 [INFO] Finished feature extraction for engine_wiring (patches=1167360, dim=1536) in 29.20s (9.76 images/sec)
2026-01-04 20:03:02,787 [INFO] Applying random coreset sampling (ratio=0.100 total=1167360 target=5000)
2026-01-04 20:03:02,794 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:03:02,980 [INFO] Saved engine_wiring checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_1\engine_wiring_patchcore.pt
2026-01-04 20:03:02,980 [INFO] [Client 1] fit(engine_wiring) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_1\engine_wiring_patchcore.pt
2026-01-04 20:03:03,060 [INFO] [Client 1] fit(pipe_clip) start
2026-01-04 20:03:03,061 [INFO] Starting feature extraction for pipe_clip (images=195)
Extracting pipe_clip features:   0%|          | 0/49 [00:00<?, ?it/s]Extracting pipe_clip features:   2%|2         | 1/49 [00:13<10:24, 13.01s/it]Extracting pipe_clip features:   8%|8         | 4/49 [00:13<01:52,  2.50s/it]Extracting pipe_clip features:  18%|#8        | 9/49 [00:13<00:34,  1.16it/s]Extracting pipe_clip features:  33%|###2      | 16/49 [00:13<00:12,  2.61it/s]Extracting pipe_clip features:  43%|####2     | 21/49 [00:13<00:07,  3.99it/s]Extracting pipe_clip features:  57%|#####7    | 28/49 [00:13<00:03,  6.63it/s]Extracting pipe_clip features:  71%|#######1  | 35/49 [00:13<00:01, 10.00it/s]Extracting pipe_clip features:  86%|########5 | 42/49 [00:13<00:00, 14.21it/s]Extracting pipe_clip features: 100%|##########| 49/49 [00:14<00:00, 17.43it/s]Extracting pipe_clip features: 100%|##########| 49/49 [00:14<00:00,  3.37it/s]
2026-01-04 20:03:17,826 [INFO] Finished feature extraction for pipe_clip (patches=798720, dim=1536) in 14.55s (13.40 images/sec)
2026-01-04 20:03:17,827 [INFO] Applying random coreset sampling (ratio=0.100 total=798720 target=5000)
2026-01-04 20:03:17,833 [INFO] random coreset sampling finished in 0.01s
2026-01-04 20:03:18,008 [INFO] Saved pipe_clip checkpoint with 5000 features to federated_sequentially\artifacts\federated_sequential\clients\client_1\pipe_clip_patchcore.pt
2026-01-04 20:03:18,093 [INFO] [Client 1] fit(pipe_clip) done: bank=(5000, 1536) checkpoint=federated_sequentially\artifacts\federated_sequential\clients\client_1\pipe_clip_patchcore.pt
2026-01-04 20:03:18,313 [INFO] [Client 1] Upload OK
